{"ast":null,"code":"var _jsxFileName = \"/Users/firanolabdisa/Desktop/tuan/2/cs472-project/daily-diary-front/src/contexts/PostsContext.tsx\",\n  _s = $RefreshSig$();\nimport { createContext, useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initStateValue = {\n  posts: [],\n  searchDate: new Date(),\n  isVoted: false,\n  isAddedNew: false,\n  loading: false,\n  notify: {\n    status: \"success\",\n    message: \"\"\n  }\n};\nconst initContextValue = {\n  ...initStateValue,\n  updatePosts: () => {},\n  updateSearchDate: () => {},\n  updateIsVoted: () => {},\n  updateIsAddedNew: () => {},\n  updateLoading: () => {},\n  updateNotify: () => {},\n  updatePost: () => {},\n  deletePost: () => {} // Added deletePost initialization\n};\nexport const GlobalContext = /*#__PURE__*/createContext(initContextValue);\nexport function PostsContext({\n  children\n}) {\n  _s();\n  const [state, setState] = useState(initStateValue);\n  const updatePosts = posts => {\n    setState(prev => ({\n      ...prev,\n      posts\n    }));\n  };\n  const updateSearchDate = searchDate => {\n    setState(prev => ({\n      ...prev,\n      searchDate\n    }));\n  };\n  const updateIsVoted = isVoted => {\n    setState(prev => ({\n      ...prev,\n      isVoted\n    }));\n  };\n  const updateIsAddedNew = isAddedNew => {\n    setState(prev => ({\n      ...prev,\n      isAddedNew\n    }));\n  };\n  const updateLoading = loading => {\n    setState(prev => ({\n      ...prev,\n      loading\n    }));\n  };\n  const updateNotify = notify => {\n    setState(prev => ({\n      ...prev,\n      notify\n    }));\n  };\n\n  // Function to update a post\n  const updatePost = (id, updatedData) => {\n    fetch(`http://localhost:8080/api/posts/${id}`, {\n      method: \"PUT\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        ...updatedData,\n        date: state.searchDate.toISOString().split('T')[0]\n      })\n    }).then(response => {\n      if (!response.ok) {\n        return response.text().then(error => {\n          console.error(\"Error response from backend:\", error);\n          throw new Error(`Failed to update the post. Server response: ${error}`);\n        });\n      }\n      return response.json();\n    }).then(updatedPost => {\n      setState(prev => ({\n        ...prev,\n        posts: prev.posts.map(post => post.id === id ? updatedPost : post)\n      }));\n      updateNotify({\n        status: \"success\",\n        message: \"Post updated successfully\"\n      });\n    }).catch(error => {\n      console.error(\"Error updating post:\", error);\n      updateNotify({\n        status: \"error\",\n        message: error.message || \"Failed to update the post\"\n      });\n    });\n  };\n\n  // Function to delete a post\n  const deletePost = id => {\n    fetch(`http://localhost:8080/api/posts/${id}?date=${state.searchDate.toISOString().split('T')[0]}`, {\n      method: \"DELETE\"\n    }).then(response => {\n      if (!response.ok) {\n        return response.text().then(error => {\n          console.error(\"Error response from backend:\", error);\n          throw new Error(`Failed to delete the post. Server response: ${error}`);\n        });\n      }\n      setState(prev => ({\n        ...prev,\n        posts: prev.posts.filter(post => post.id !== id)\n      }));\n      updateNotify({\n        status: \"success\",\n        message: \"Post deleted successfully\"\n      });\n    }).catch(error => {\n      console.error(\"Error deleting post:\", error);\n      updateNotify({\n        status: \"error\",\n        message: error.message || \"Failed to delete the post\"\n      });\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(GlobalContext.Provider, {\n    value: {\n      posts: state.posts,\n      searchDate: state.searchDate,\n      isVoted: state.isVoted,\n      isAddedNew: state.isAddedNew,\n      loading: state.loading,\n      notify: state.notify,\n      updatePosts,\n      updateSearchDate,\n      updateIsVoted,\n      updateIsAddedNew,\n      updateLoading,\n      updateNotify,\n      updatePost,\n      deletePost // Provide the deletePost function in the context\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 142,\n    columnNumber: 9\n  }, this);\n}\n_s(PostsContext, \"8NE/LJNgMuB9zFYEYahgz0RSuEM=\");\n_c = PostsContext;\nvar _c;\n$RefreshReg$(_c, \"PostsContext\");","map":{"version":3,"names":["createContext","useState","jsxDEV","_jsxDEV","initStateValue","posts","searchDate","Date","isVoted","isAddedNew","loading","notify","status","message","initContextValue","updatePosts","updateSearchDate","updateIsVoted","updateIsAddedNew","updateLoading","updateNotify","updatePost","deletePost","GlobalContext","PostsContext","children","_s","state","setState","prev","id","updatedData","fetch","method","headers","body","JSON","stringify","date","toISOString","split","then","response","ok","text","error","console","Error","json","updatedPost","map","post","catch","filter","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/firanolabdisa/Desktop/tuan/2/cs472-project/daily-diary-front/src/contexts/PostsContext.tsx"],"sourcesContent":["import { createContext, ReactNode, useState } from \"react\";\nimport { Post } from \"../models/Post\";\nimport { AlertColor } from \"@mui/material\";\n\ntype StateType = {\n    posts: Post[];\n    searchDate: Date;\n    isVoted: boolean;\n    isAddedNew: boolean;\n    loading: boolean;\n    notify: Notify;\n};\n\ntype Notify = {\n    status: AlertColor;\n    message: string;\n};\n\nconst initStateValue = {\n    posts: [] as Post[],\n    searchDate: new Date(),\n    isVoted: false,\n    isAddedNew: false,\n    loading: false,\n    notify: { status: \"success\" as AlertColor, message: \"\" },\n};\n\nexport type ContextType = {\n    posts: Post[];\n    searchDate: Date;\n    isVoted: boolean;\n    isAddedNew: boolean;\n    loading: boolean;\n    notify: Notify;\n    updatePosts: (posts: Post[]) => void;\n    updateSearchDate: (searchDate: Date) => void;\n    updateIsVoted: (isVoted: boolean) => void;\n    updateIsAddedNew: (isAddedNew: boolean) => void;\n    updateLoading: (loading: boolean) => void;\n    updateNotify: (notify: Notify) => void;\n    updatePost: (id: string, updatedData: { title: string; body: string }) => void;\n    deletePost: (id: string) => void; // Added deletePost type\n};\n\nconst initContextValue: ContextType = {\n    ...initStateValue,\n    updatePosts: () => {},\n    updateSearchDate: () => {},\n    updateIsVoted: () => {},\n    updateIsAddedNew: () => {},\n    updateLoading: () => {},\n    updateNotify: () => {},\n    updatePost: () => {},\n    deletePost: () => {}, // Added deletePost initialization\n};\n\nexport const GlobalContext = createContext(initContextValue);\n\nexport function PostsContext({ children }: { children: ReactNode }) {\n    const [state, setState] = useState<StateType>(initStateValue);\n\n    const updatePosts = (posts: Post[]) => {\n        setState((prev) => ({ ...prev, posts }));\n    };\n\n    const updateSearchDate = (searchDate: Date) => {\n        setState((prev) => ({ ...prev, searchDate }));\n    };\n\n    const updateIsVoted = (isVoted: boolean) => {\n        setState((prev) => ({ ...prev, isVoted }));\n    };\n\n    const updateIsAddedNew = (isAddedNew: boolean) => {\n        setState((prev) => ({ ...prev, isAddedNew }));\n    };\n\n    const updateLoading = (loading: boolean) => {\n        setState((prev) => ({ ...prev, loading }));\n    };\n\n    const updateNotify = (notify: Notify) => {\n        setState((prev) => ({ ...prev, notify }));\n    };\n\n    // Function to update a post\n    const updatePost = (id: string, updatedData: { title: string; body: string }) => {\n        fetch(`http://localhost:8080/api/posts/${id}`, {\n            method: \"PUT\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({ ...updatedData, date: state.searchDate.toISOString().split('T')[0] }),\n        })\n            .then(response => {\n                if (!response.ok) {\n                    return response.text().then((error) => {\n                        console.error(\"Error response from backend:\", error);\n                        throw new Error(`Failed to update the post. Server response: ${error}`);\n                    });\n                }\n                return response.json();\n            })\n            .then((updatedPost: Post) => {\n                setState((prev) => ({\n                    ...prev,\n                    posts: prev.posts.map((post) => (post.id === id ? updatedPost : post)),\n                }));\n                updateNotify({ status: \"success\", message: \"Post updated successfully\" });\n            })\n            .catch(error => {\n                console.error(\"Error updating post:\", error);\n                updateNotify({ status: \"error\", message: error.message || \"Failed to update the post\" });\n            });\n    };\n\n    // Function to delete a post\n    const deletePost = (id: string) => {\n        fetch(`http://localhost:8080/api/posts/${id}?date=${state.searchDate.toISOString().split('T')[0]}`, {\n            method: \"DELETE\",\n        })\n            .then(response => {\n                if (!response.ok) {\n                    return response.text().then((error) => {\n                        console.error(\"Error response from backend:\", error);\n                        throw new Error(`Failed to delete the post. Server response: ${error}`);\n                    });\n                }\n                setState((prev) => ({\n                    ...prev,\n                    posts: prev.posts.filter((post) => post.id !== id),\n                }));\n                updateNotify({ status: \"success\", message: \"Post deleted successfully\" });\n            })\n            .catch(error => {\n                console.error(\"Error deleting post:\", error);\n                updateNotify({ status: \"error\", message: error.message || \"Failed to delete the post\" });\n            });\n    };\n\n    return (\n        <GlobalContext.Provider\n            value={{\n                posts: state.posts,\n                searchDate: state.searchDate,\n                isVoted: state.isVoted,\n                isAddedNew: state.isAddedNew,\n                loading: state.loading,\n                notify: state.notify,\n                updatePosts,\n                updateSearchDate,\n                updateIsVoted,\n                updateIsAddedNew,\n                updateLoading,\n                updateNotify,\n                updatePost, \n                deletePost, // Provide the deletePost function in the context\n            }}\n        >\n            {children}\n        </GlobalContext.Provider>\n    );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}